"use strict";
Page({
    data: {
        caiId: '',
        goodsDetailData: {},
        isCollected: false,
        goods_introduce: '',
        carts: wx.getStorageSync('carts') || []
    },
    onLoad: function (options) {
        this.data.caiId = options.id || '';
        this.getGoodDetail();
    },
    addToCarts: function () {
        var _this = this;
        var carts = this.data.carts;
        var index = carts.findIndex(function (item) {
            return item.goodsDetail.goods_id === _this.data.goodsDetailData.goods_id;
        });
        if (index === -1) {
            var goodsIitem = {
                number: 1,
                goods_id: this.data.goodsDetailData.goods_id,
                goodsDetail: this.data.goodsDetailData
            };
            carts.push(goodsIitem);
        }
        else {
            carts[index].number++;
        }
        wx.setStorageSync('carts', carts);
        this.setData({ carts: wx.getStorageSync('carts') });
        wx.showToast({
            title: '添加成功',
            duration: 1500,
            mask: true,
        });
    },
    redirect: function () {
        wx.navigateTo({
            url: '/pages/cart/index'
        });
    },
    onClickButton: function () {
        console.log('点击按钮');
    },
    changeCollected: function () {
        this.setData({ isCollected: !this.data.isCollected });
    },
    checkDetail: function (e) {
        var imagesURL = [];
        for (var _i = 0, _a = this.data.goodsDetailData.pics; _i < _a.length; _i++) {
            var items = _a[_i];
            imagesURL.push(items.pics_big_url);
        }
        wx.previewImage({
            current: e.currentTarget.dataset.cur.pics_big_url || '',
            urls: imagesURL
        });
    },
    getGoodDetail: function () {
        var _this = this;
        var params = {
            goods_id: this.data.caiId
        };
        getApp().request('/goods/detail', params).then(function (res) {
            _this.setData({ goodsDetailData: res.data.message });
            _this.setData({ goods_introduce: _this.data.goodsDetailData.goods_introduce.replace(/\.webp/g, '.jpg') });
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBTUEsSUFBSSxDQUFDO0lBSUgsSUFBSSxFQUFFO1FBQ0osS0FBSyxFQUFVLEVBQUU7UUFDakIsZUFBZSxFQUFhLEVBQUU7UUFDOUIsV0FBVyxFQUFFLEtBQUs7UUFDbEIsZUFBZSxFQUFFLEVBQUU7UUFDbkIsS0FBSyxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRTtLQUN4QztJQUtELE1BQU0sRUFBTixVQUFPLE9BQU87UUFDWixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQTtRQUNsQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUNELFVBQVUsRUFBVjtRQUFBLGlCQTJCQztRQXpCQyxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQTtRQUU3QixJQUFNLEtBQUssR0FBVyxLQUFLLENBQUMsU0FBUyxDQUFDLFVBQUMsSUFBZTtZQUVwRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxLQUFNLEtBQUksQ0FBQyxJQUFJLENBQUMsZUFBdUIsQ0FBQyxRQUFRLENBQUE7UUFDbEYsQ0FBQyxDQUFDLENBQUE7UUFDRixJQUFJLEtBQUssS0FBSyxDQUFDLENBQUMsRUFBRTtZQUVoQixJQUFNLFVBQVUsR0FBYztnQkFDNUIsTUFBTSxFQUFFLENBQUM7Z0JBQ1QsUUFBUSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVE7Z0JBQzVDLFdBQVcsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWU7YUFDdkMsQ0FBQTtZQUVELEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7U0FDdkI7YUFBTTtZQUNMLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQTtTQUN0QjtRQUNELEVBQUUsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDbkQsRUFBRSxDQUFDLFNBQVMsQ0FBQztZQUNYLEtBQUssRUFBRSxNQUFNO1lBQ2IsUUFBUSxFQUFFLElBQUk7WUFDZCxJQUFJLEVBQUUsSUFBSTtTQUNYLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDRCxRQUFRO1FBQ04sRUFBRSxDQUFDLFVBQVUsQ0FBQztZQUNaLEdBQUcsRUFBRSxtQkFBbUI7U0FDekIsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUNELGFBQWE7UUFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFFRCxlQUFlO1FBQ2IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLFdBQVcsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQTtJQUN2RCxDQUFDO0lBRUQsV0FBVyxFQUFYLFVBQVksQ0FBTTtRQUNoQixJQUFNLFNBQVMsR0FBa0IsRUFBRSxDQUFBO1FBQ25DLEtBQW9CLFVBQThCLEVBQTlCLEtBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUE5QixjQUE4QixFQUE5QixJQUE4QixFQUFFO1lBQS9DLElBQU0sS0FBSyxTQUFBO1lBQ2QsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUE7U0FDbkM7UUFDRCxFQUFFLENBQUMsWUFBWSxDQUFDO1lBQ2QsT0FBTyxFQUFFLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLElBQUksRUFBRTtZQUN2RCxJQUFJLEVBQUUsU0FBUztTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsYUFBYSxFQUFiO1FBQUEsaUJBV0M7UUFWQyxJQUFNLE1BQU0sR0FBRztZQUNiLFFBQVEsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUs7U0FDMUIsQ0FBQTtRQUNELE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsR0FBUTtZQUd0RCxLQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsZUFBZSxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtZQUVuRCxLQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsZUFBZSxFQUFHLEtBQUksQ0FBQyxJQUFJLENBQUMsZUFBdUIsQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDbEgsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0NBRUYsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsidHlwZSBnb29kc0l0ZW0gPSB7XG4gIG51bWJlcjogbnVtYmVyLFxuICBnb29kc0RldGFpbDogYW55LFxuICBnb29kc19pZDogbnVtYmVyLFxuICBbcHJvcE5hbWU6IHN0cmluZ106IGFueVxufVxuUGFnZSh7XG4gIC8qKlxuICAgKiDpobXpnaLnmoTliJ3lp4vmlbDmja5cbiAgICovXG4gIGRhdGE6IHtcbiAgICBjYWlJZDogPHN0cmluZz4nJyxcbiAgICBnb29kc0RldGFpbERhdGE6IDxnb29kc0l0ZW0+e30sXG4gICAgaXNDb2xsZWN0ZWQ6IGZhbHNlLFxuICAgIGdvb2RzX2ludHJvZHVjZTogJycsXG4gICAgY2FydHM6IHd4LmdldFN0b3JhZ2VTeW5jKCdjYXJ0cycpIHx8IFtdXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yqg6L29XG4gICAqL1xuICBvbkxvYWQob3B0aW9ucyk6IHZvaWQge1xuICAgIHRoaXMuZGF0YS5jYWlJZCA9IG9wdGlvbnMuaWQgfHwgJydcbiAgICB0aGlzLmdldEdvb2REZXRhaWwoKVxuICB9LFxuICBhZGRUb0NhcnRzKCkge1xuXG4gICAgY29uc3QgY2FydHMgPSB0aGlzLmRhdGEuY2FydHNcblxuICAgIGNvbnN0IGluZGV4OiBudW1iZXIgPSBjYXJ0cy5maW5kSW5kZXgoKGl0ZW06IGdvb2RzSXRlbSkgPT4ge1xuXG4gICAgICByZXR1cm4gaXRlbS5nb29kc0RldGFpbC5nb29kc19pZCA9PT0gKHRoaXMuZGF0YS5nb29kc0RldGFpbERhdGEgYXMgYW55KS5nb29kc19pZFxuICAgIH0pXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuXG4gICAgICBjb25zdCBnb29kc0lpdGVtOiBnb29kc0l0ZW0gPSB7XG4gICAgICAgIG51bWJlcjogMSxcbiAgICAgICAgZ29vZHNfaWQ6IHRoaXMuZGF0YS5nb29kc0RldGFpbERhdGEuZ29vZHNfaWQsXG4gICAgICAgIGdvb2RzRGV0YWlsOiB0aGlzLmRhdGEuZ29vZHNEZXRhaWxEYXRhXG4gICAgICB9XG5cbiAgICAgIGNhcnRzLnB1c2goZ29vZHNJaXRlbSlcbiAgICB9IGVsc2Uge1xuICAgICAgY2FydHNbaW5kZXhdLm51bWJlcisrXG4gICAgfVxuICAgIHd4LnNldFN0b3JhZ2VTeW5jKCdjYXJ0cycsIGNhcnRzKVxuICAgIHRoaXMuc2V0RGF0YSh7IGNhcnRzOiB3eC5nZXRTdG9yYWdlU3luYygnY2FydHMnKSB9KVxuICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICB0aXRsZTogJ+a3u+WKoOaIkOWKnycsXG4gICAgICBkdXJhdGlvbjogMTUwMCxcbiAgICAgIG1hc2s6IHRydWUsXG4gICAgfSk7XG4gIH0sXG4gIHJlZGlyZWN0KCkge1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOiAnL3BhZ2VzL2NhcnQvaW5kZXgnXG4gICAgfSlcbiAgfSxcbiAgb25DbGlja0J1dHRvbigpIHtcbiAgICBjb25zb2xlLmxvZygn54K55Ye75oyJ6ZKuJyk7XG4gIH0sXG4gIC8v5pS55Y+Y5pS26JeP54q25oCBXG4gIGNoYW5nZUNvbGxlY3RlZCgpIHtcbiAgICB0aGlzLnNldERhdGEoeyBpc0NvbGxlY3RlZDogIXRoaXMuZGF0YS5pc0NvbGxlY3RlZCB9KVxuICB9LFxuICAvL+eCueWHu+WbvueJh+aXtuWFqOWxgOafpeeci1xuICBjaGVja0RldGFpbChlOiBhbnkpOiB2b2lkIHtcbiAgICBjb25zdCBpbWFnZXNVUkw6IEFycmF5PHN0cmluZz4gPSBbXVxuICAgIGZvciAoY29uc3QgaXRlbXMgb2YgdGhpcy5kYXRhLmdvb2RzRGV0YWlsRGF0YS5waWNzKSB7XG4gICAgICBpbWFnZXNVUkwucHVzaChpdGVtcy5waWNzX2JpZ191cmwpXG4gICAgfVxuICAgIHd4LnByZXZpZXdJbWFnZSh7XG4gICAgICBjdXJyZW50OiBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5jdXIucGljc19iaWdfdXJsIHx8ICcnLCAvLyDlvZPliY3mmL7npLrlm77niYfnmoRodHRw6ZO+5o6lXG4gICAgICB1cmxzOiBpbWFnZXNVUkwgLy8g6ZyA6KaB6aKE6KeI55qE5Zu+54mHaHR0cOmTvuaOpeWIl+ihqFxuICAgIH0pXG4gIH0sXG4gIC8v6I635Y+W5ZWG5ZOB6K+m5oOFXG4gIGdldEdvb2REZXRhaWwoKTogdm9pZCB7XG4gICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgZ29vZHNfaWQ6IHRoaXMuZGF0YS5jYWlJZFxuICAgIH1cbiAgICBnZXRBcHAoKS5yZXF1ZXN0KCcvZ29vZHMvZGV0YWlsJywgcGFyYW1zKS50aGVuKChyZXM6IGFueSkgPT4ge1xuXG5cbiAgICAgIHRoaXMuc2V0RGF0YSh7IGdvb2RzRGV0YWlsRGF0YTogcmVzLmRhdGEubWVzc2FnZSB9KVxuXG4gICAgICB0aGlzLnNldERhdGEoeyBnb29kc19pbnRyb2R1Y2U6ICh0aGlzLmRhdGEuZ29vZHNEZXRhaWxEYXRhIGFzIGFueSkuZ29vZHNfaW50cm9kdWNlLnJlcGxhY2UoL1xcLndlYnAvZywgJy5qcGcnKSB9KVxuICAgIH0pXG4gIH1cblxufSkiXX0=