"use strict";
Page({
    data: {
        caiId: '',
        goodsDetailData: {},
        isCollected: false,
        goods_introduce: '',
        carts: wx.getStorageSync('cart')
    },
    onLoad: function (options) {
        this.data.caiId = options.id || '';
        this.getGoodDetail();
    },
    onShow: function () {
        this.setData({ carts: wx.getStorageSync("cart") });
    },
    addToCarts: function () {
        var _this = this;
        var carts = this.data.carts === '' ? [] : this.data.carts;
        var index = carts.findIndex(function (item) {
            return item.goodsDetail.goods_id === _this.data.goodsDetailData.goods_id;
        });
        if (index === -1) {
            var goodsIitem = {
                number: 1,
                goods_id: this.data.goodsDetailData.goods_id,
                goodsDetail: this.data.goodsDetailData
            };
            carts.push(goodsIitem);
        }
        else {
            carts[index].number++;
        }
        wx.setStorageSync('cart', carts);
        this.setData({ carts: wx.getStorageSync('cart') });
        wx.showToast({
            title: '添加成功',
            duration: 1500,
            mask: true,
        });
    },
    redirect: function () {
        wx.navigateTo({
            url: '/pages/cart/index'
        });
    },
    onClickButton: function () {
        console.log('点击按钮');
    },
    changeCollected: function () {
        this.setData({ isCollected: !this.data.isCollected });
    },
    checkDetail: function (e) {
        var imagesURL = [];
        for (var _i = 0, _a = this.data.goodsDetailData.pics; _i < _a.length; _i++) {
            var items = _a[_i];
            imagesURL.push(items.pics_big_url);
        }
        wx.previewImage({
            current: e.currentTarget.dataset.cur.pics_big_url || '',
            urls: imagesURL
        });
    },
    getGoodDetail: function () {
        var _this = this;
        var params = {
            goods_id: this.data.caiId
        };
        getApp().request('/goods/detail', params).then(function (res) {
            _this.setData({ goodsDetailData: res.data.message });
            _this.setData({ goods_introduce: _this.data.goodsDetailData.goods_introduce.replace(/\.webp/g, '.jpg') });
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBTUEsSUFBSSxDQUFDO0lBSUgsSUFBSSxFQUFFO1FBQ0osS0FBSyxFQUFVLEVBQUU7UUFDakIsZUFBZSxFQUFhLEVBQUU7UUFDOUIsV0FBVyxFQUFFLEtBQUs7UUFDbEIsZUFBZSxFQUFFLEVBQUU7UUFDbkIsS0FBSyxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDO0tBQ2pDO0lBS0QsTUFBTSxFQUFOLFVBQU8sT0FBTztRQUNaLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFBO1FBQ2xDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQTtJQUN0QixDQUFDO0lBSUQsTUFBTTtRQUNKLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUE7SUFDcEQsQ0FBQztJQUNELFVBQVUsRUFBVjtRQUFBLGlCQTBCQztRQXpCQyxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUE7UUFDM0QsSUFBTSxLQUFLLEdBQVcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFDLElBQWU7WUFFcEQsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsS0FBTSxLQUFJLENBQUMsSUFBSSxDQUFDLGVBQXVCLENBQUMsUUFBUSxDQUFBO1FBQ2xGLENBQUMsQ0FBQyxDQUFBO1FBRUYsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUU7WUFFaEIsSUFBTSxVQUFVLEdBQWM7Z0JBQzVCLE1BQU0sRUFBRSxDQUFDO2dCQUNULFFBQVEsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRO2dCQUM1QyxXQUFXLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlO2FBQ3ZDLENBQUE7WUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1NBQ3ZCO2FBQU07WUFDTCxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7U0FDdEI7UUFDRCxFQUFFLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNoQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQ2xELEVBQUUsQ0FBQyxTQUFTLENBQUM7WUFDWCxLQUFLLEVBQUUsTUFBTTtZQUNiLFFBQVEsRUFBRSxJQUFJO1lBQ2QsSUFBSSxFQUFFLElBQUk7U0FDWCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0QsUUFBUTtRQUNOLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsbUJBQW1CO1NBQ3pCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxhQUFhO1FBQ1gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBRUQsZUFBZTtRQUNiLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUE7SUFDdkQsQ0FBQztJQUVELFdBQVcsRUFBWCxVQUFZLENBQU07UUFDaEIsSUFBTSxTQUFTLEdBQWtCLEVBQUUsQ0FBQTtRQUNuQyxLQUFvQixVQUE4QixFQUE5QixLQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBOUIsY0FBOEIsRUFBOUIsSUFBOEIsRUFBRTtZQUEvQyxJQUFNLEtBQUssU0FBQTtZQUNkLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFBO1NBQ25DO1FBQ0QsRUFBRSxDQUFDLFlBQVksQ0FBQztZQUNkLE9BQU8sRUFBRSxDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxJQUFJLEVBQUU7WUFDdkQsSUFBSSxFQUFFLFNBQVM7U0FDaEIsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELGFBQWEsRUFBYjtRQUFBLGlCQVdDO1FBVkMsSUFBTSxNQUFNLEdBQUc7WUFDYixRQUFRLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLO1NBQzFCLENBQUE7UUFDRCxNQUFNLEVBQUUsQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLEdBQVE7WUFHdEQsS0FBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLGVBQWUsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUE7WUFFbkQsS0FBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLGVBQWUsRUFBRyxLQUFJLENBQUMsSUFBSSxDQUFDLGVBQXVCLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQ2xILENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUVGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbInR5cGUgZ29vZHNJdGVtID0ge1xuICBudW1iZXI6IG51bWJlcixcbiAgZ29vZHNEZXRhaWw6IGFueSxcbiAgZ29vZHNfaWQ6IG51bWJlcixcbiAgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnlcbn1cblBhZ2Uoe1xuICAvKipcbiAgICog6aG16Z2i55qE5Yid5aeL5pWw5o2uXG4gICAqL1xuICBkYXRhOiB7XG4gICAgY2FpSWQ6IDxzdHJpbmc+JycsXG4gICAgZ29vZHNEZXRhaWxEYXRhOiA8Z29vZHNJdGVtPnt9LFxuICAgIGlzQ29sbGVjdGVkOiBmYWxzZSxcbiAgICBnb29kc19pbnRyb2R1Y2U6ICcnLFxuICAgIGNhcnRzOiB3eC5nZXRTdG9yYWdlU3luYygnY2FydCcpXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yqg6L29XG4gICAqL1xuICBvbkxvYWQob3B0aW9ucyk6IHZvaWQge1xuICAgIHRoaXMuZGF0YS5jYWlJZCA9IG9wdGlvbnMuaWQgfHwgJydcbiAgICB0aGlzLmdldEdvb2REZXRhaWwoKVxuICB9LFxuICAvKipcbiAgICog6aG16Z2i5pi+56S6XG4gICAqL1xuICBvblNob3coKSB7XG4gICAgdGhpcy5zZXREYXRhKHsgY2FydHM6IHd4LmdldFN0b3JhZ2VTeW5jKFwiY2FydFwiKSB9KVxuICB9LFxuICBhZGRUb0NhcnRzKCkge1xuICAgIGNvbnN0IGNhcnRzID0gdGhpcy5kYXRhLmNhcnRzID09PSAnJyA/IFtdIDogdGhpcy5kYXRhLmNhcnRzXG4gICAgY29uc3QgaW5kZXg6IG51bWJlciA9IGNhcnRzLmZpbmRJbmRleCgoaXRlbTogZ29vZHNJdGVtKSA9PiB7XG5cbiAgICAgIHJldHVybiBpdGVtLmdvb2RzRGV0YWlsLmdvb2RzX2lkID09PSAodGhpcy5kYXRhLmdvb2RzRGV0YWlsRGF0YSBhcyBhbnkpLmdvb2RzX2lkXG4gICAgfSlcblxuICAgIGlmIChpbmRleCA9PT0gLTEpIHtcblxuICAgICAgY29uc3QgZ29vZHNJaXRlbTogZ29vZHNJdGVtID0ge1xuICAgICAgICBudW1iZXI6IDEsXG4gICAgICAgIGdvb2RzX2lkOiB0aGlzLmRhdGEuZ29vZHNEZXRhaWxEYXRhLmdvb2RzX2lkLFxuICAgICAgICBnb29kc0RldGFpbDogdGhpcy5kYXRhLmdvb2RzRGV0YWlsRGF0YVxuICAgICAgfVxuXG4gICAgICBjYXJ0cy5wdXNoKGdvb2RzSWl0ZW0pXG4gICAgfSBlbHNlIHtcbiAgICAgIGNhcnRzW2luZGV4XS5udW1iZXIrK1xuICAgIH1cbiAgICB3eC5zZXRTdG9yYWdlU3luYygnY2FydCcsIGNhcnRzKVxuICAgIHRoaXMuc2V0RGF0YSh7IGNhcnRzOiB3eC5nZXRTdG9yYWdlU3luYygnY2FydCcpIH0pXG4gICAgd3guc2hvd1RvYXN0KHtcbiAgICAgIHRpdGxlOiAn5re75Yqg5oiQ5YqfJyxcbiAgICAgIGR1cmF0aW9uOiAxNTAwLFxuICAgICAgbWFzazogdHJ1ZSxcbiAgICB9KTtcbiAgfSxcbiAgcmVkaXJlY3QoKSB7XG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6ICcvcGFnZXMvY2FydC9pbmRleCdcbiAgICB9KVxuICB9LFxuICBvbkNsaWNrQnV0dG9uKCkge1xuICAgIGNvbnNvbGUubG9nKCfngrnlh7vmjInpkq4nKTtcbiAgfSxcbiAgLy/mlLnlj5jmlLbol4/nirbmgIFcbiAgY2hhbmdlQ29sbGVjdGVkKCkge1xuICAgIHRoaXMuc2V0RGF0YSh7IGlzQ29sbGVjdGVkOiAhdGhpcy5kYXRhLmlzQ29sbGVjdGVkIH0pXG4gIH0sXG4gIC8v54K55Ye75Zu+54mH5pe25YWo5bGA5p+l55yLXG4gIGNoZWNrRGV0YWlsKGU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGltYWdlc1VSTDogQXJyYXk8c3RyaW5nPiA9IFtdXG4gICAgZm9yIChjb25zdCBpdGVtcyBvZiB0aGlzLmRhdGEuZ29vZHNEZXRhaWxEYXRhLnBpY3MpIHtcbiAgICAgIGltYWdlc1VSTC5wdXNoKGl0ZW1zLnBpY3NfYmlnX3VybClcbiAgICB9XG4gICAgd3gucHJldmlld0ltYWdlKHtcbiAgICAgIGN1cnJlbnQ6IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmN1ci5waWNzX2JpZ191cmwgfHwgJycsIC8vIOW9k+WJjeaYvuekuuWbvueJh+eahGh0dHDpk77mjqVcbiAgICAgIHVybHM6IGltYWdlc1VSTCAvLyDpnIDopoHpooTop4jnmoTlm77niYdodHRw6ZO+5o6l5YiX6KGoXG4gICAgfSlcbiAgfSxcbiAgLy/ojrflj5bllYblk4Hor6bmg4VcbiAgZ2V0R29vZERldGFpbCgpOiB2b2lkIHtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICBnb29kc19pZDogdGhpcy5kYXRhLmNhaUlkXG4gICAgfVxuICAgIGdldEFwcCgpLnJlcXVlc3QoJy9nb29kcy9kZXRhaWwnLCBwYXJhbXMpLnRoZW4oKHJlczogYW55KSA9PiB7XG5cblxuICAgICAgdGhpcy5zZXREYXRhKHsgZ29vZHNEZXRhaWxEYXRhOiByZXMuZGF0YS5tZXNzYWdlIH0pXG5cbiAgICAgIHRoaXMuc2V0RGF0YSh7IGdvb2RzX2ludHJvZHVjZTogKHRoaXMuZGF0YS5nb29kc0RldGFpbERhdGEgYXMgYW55KS5nb29kc19pbnRyb2R1Y2UucmVwbGFjZSgvXFwud2VicC9nLCAnLmpwZycpIH0pXG4gICAgfSlcbiAgfVxuXG59KSJdfQ==